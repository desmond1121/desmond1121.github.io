<!DOCTYPE html><html class="theme-next mist use-motion" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/luffy.img?v=5.1.3"><link rel="icon" type="image/png" sizes="32x32" href="/images/luffy.img?v=5.1.3"><link rel="icon" type="image/png" sizes="16x16" href="/images/luffy.img?v=5.1.3"><link rel="mask-icon" href="/images/luffy.img?v=5.1.3" color="#222"><meta name="keywords" content="Android,"><meta name="description" content="在开发一块新功能的过程中，我们通常会涉及到与后端接口联调的问题。新的界面、新的后端接口，这时候在开发的时候往往前端就很尴尬，后端不依赖前端，但是前端十分依赖后端。大部分应用都会有或多或少地依赖后端数据，有的界面只需要简单搞个假数据传入即可，但是我们还需要应对很多复杂情况，比如：处理无数据、返回错误、各类非正常的状态；处理分页数据的情况；模拟一个请求中、请求失败、请求结果返回的情景；这时候如果能够写"><meta name="keywords" content="Android"><meta property="og:type" content="article"><meta property="og:title" content="如何在开发过程中搭建简单的假数据服务器"><meta property="og:url" content="http://blog.desmondyao.com/fake-server/index.html"><meta property="og:site_name" content="Desmond&#39;s Blog"><meta property="og:description" content="在开发一块新功能的过程中，我们通常会涉及到与后端接口联调的问题。新的界面、新的后端接口，这时候在开发的时候往往前端就很尴尬，后端不依赖前端，但是前端十分依赖后端。大部分应用都会有或多或少地依赖后端数据，有的界面只需要简单搞个假数据传入即可，但是我们还需要应对很多复杂情况，比如：处理无数据、返回错误、各类非正常的状态；处理分页数据的情况；模拟一个请求中、请求失败、请求结果返回的情景；这时候如果能够写"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="http://blog.desmondyao.com/image/fake-server-0.png"><meta property="og:image" content="http://blog.desmondyao.com/image/fake-server.png"><meta property="og:updated_time" content="2017-11-06T12:30:53.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="如何在开发过程中搭建简单的假数据服务器"><meta name="twitter:description" content="在开发一块新功能的过程中，我们通常会涉及到与后端接口联调的问题。新的界面、新的后端接口，这时候在开发的时候往往前端就很尴尬，后端不依赖前端，但是前端十分依赖后端。大部分应用都会有或多或少地依赖后端数据，有的界面只需要简单搞个假数据传入即可，但是我们还需要应对很多复杂情况，比如：处理无数据、返回错误、各类非正常的状态；处理分页数据的情况；模拟一个请求中、请求失败、请求结果返回的情景；这时候如果能够写"><meta name="twitter:image" content="http://blog.desmondyao.com/image/fake-server-0.png"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Mist",version:"5.1.3",sidebar:{position:"left",display:"post",offset:12,b2t:!1,scrollpercent:!1,onmobile:!1},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="http://blog.desmondyao.com/fake-server/"><title>如何在开发过程中搭建简单的假数据服务器 | Desmond's Blog</title></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Desmond's Blog</span> <span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">Focus on Java, Android, React Native.</p></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li></ul></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="http://blog.desmondyao.com/fake-server/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Desmond Yao"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.gif"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Desmond's Blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">如何在开发过程中搭建简单的假数据服务器</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-08-01T17:45:40+08:00">2016-08-01</time></span></div></header><div class="post-body" itemprop="articleBody"><p>在开发一块新功能的过程中，我们通常会涉及到与后端接口联调的问题。新的界面、新的后端接口，这时候在开发的时候往往前端就很尴尬，后端不依赖前端，但是前端十分依赖后端。</p><p>大部分应用都会有或多或少地依赖后端数据，有的界面只需要简单搞个假数据传入即可，但是我们还需要应对很多复杂情况，比如：</p><ul><li>处理无数据、返回错误、各类非正常的状态；</li><li>处理分页数据的情况；</li><li>模拟一个请求中、请求失败、请求结果返回的情景；</li></ul><p>这时候如果能够写一个简单的服务器，你请求真实的接口url，只需要给手机设置一个代理，就返回你设置的假数据。这样你就可以完全抛开其他依赖的顾虑，可以像正常情况一样开发、校验结果，而不是依赖写死在代码里的各种假逻辑（这样做也会为后面的开发带来一些隐患）。</p><p>实际上服务器本身的逻辑是非常简单的，但是要真正得搭建成你所需要的环境，需要一些复杂功夫。本文以<a href="node">nodejs</a>为例，具体描述一下如何在本机上搭建测试服务器。</p><a id="more"></a><h2 id="使用node搭建起简单的服务器脚本"><a href="#使用node搭建起简单的服务器脚本" class="headerlink" title="使用node搭建起简单的服务器脚本"></a>使用node搭建起简单的服务器脚本</h2><h3 id="1-安装"><a href="#1-安装" class="headerlink" title="1. 安装"></a>1. 安装</h3><p>Unix 用户可以使用<a href="node-install">命令行</a>安装nodejs。</p><p>Windows 用户可以直接下载<a href="node-download">安装包</a>。</p><p>安装成功后如果在命令行下输入<code>node -v</code>能够打印出版本信息，说明安装成功了。</p><h3 id="2-简单服务器"><a href="#2-简单服务器" class="headerlink" title="2. 简单服务器"></a>2. 简单服务器</h3><p>Node 服务器可以运行在“IP:PORT”上，我们可以通过如下代码来在<code>127.0.0.1:2333</code>端口上搭建起一个简单的服务器：</p><p><em>server.js</em><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</div><div class="line">http.createServer( <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</div><div class="line">  <span class="comment">// 返回码200，返回头中标识内容为json</span></div><div class="line">  res.writeHead(<span class="number">200</span>, &#123;<span class="string">'Content-Type'</span>: <span class="string">'text/json'</span>&#125;);</div><div class="line">  <span class="keyword">let</span> resp = &#123;</div><div class="line">    code : <span class="number">0</span>,</div><div class="line">    time : <span class="number">1469981217</span>,</div><div class="line">    data : &#123;</div><div class="line">      name : <span class="string">'desmond'</span>,</div><div class="line">      gender : <span class="string">'male'</span></div><div class="line">    &#125;</div><div class="line">  &#125;;</div><div class="line">  res.end(<span class="built_in">JSON</span>.stringify(resp)); <span class="comment">// 将resp转换为JSON字符串返回。</span></div><div class="line">&#125;).listen(<span class="number">2333</span>, <span class="string">'127.0.0.1'</span>, )</div></pre></td></tr></table></figure><p></p><p>之后输入<code>node server.js</code>，然后我们到浏览器中访问<code>localhost:2333</code>就可以看见：</p><p><img src="/image/fake-server-0.png" alt="image"></p><p>具体的信息可以参考<a href="https://nodejs.org/dist/latest-v6.x/docs/api/http.html" target="_blank" rel="external">Nodejs-http</a>.</p><h3 id="3-IDE配置"><a href="#3-IDE配置" class="headerlink" title="3. IDE配置"></a>3. IDE配置</h3><p>从IDE环境切换到脚本环境来写代码总会不顺手，推荐一个我认为比较容易上手的配置吧：</p><ul><li><strong>编辑器</strong> Sublime Text 3，没啥好说的，好用。</li><li><strong>代码补全</strong> <a href="http://ternjs.net/" target="_blank" rel="external">TernJS</a>, <a href="https://github.com/ternjs/tern_for_sublime" target="_blank" rel="external">Tern-Sublime</a>，是js下代码提示、补全的利器，极其推荐！</li><li><strong>错误检查</strong> <a href="http://eslint.org/" target="_blank" rel="external">ESLint</a>, <a href="https://github.com/roadhump/SublimeLinter-eslint" target="_blank" rel="external">SublimeLinter-ESLint</a> 是一款js的静态检查、错误提示的利器，Sublime的插件也非常好用，配置很简单。</li></ul><p>配上这三个，你就会觉得用起来已经蛮舒服了。</p><h2 id="Nginx反向代理"><a href="#Nginx反向代理" class="headerlink" title="Nginx反向代理"></a>Nginx反向代理</h2><p><a href="nginx">nginx</a> 搭建服务器的强大处之一就是它的代理能力，配置也十分简洁。</p><p>如果要模拟最终的请求的话，我们应该是原封不动的保留请求url: ‘www.desmond.com/api/something’。首先我们需要 <strong>在手机上设置代理，将ip配置到自己电脑上，端口配为80</strong> 。但是你的电脑识别到这个请求后，怎么让它导流到你的node服务器，这是一个问题。如果你代码写死的ip+端口来访问，未免有点太low了，我们既然折腾了这么多，那可以继续往下走一步：<a href="https://zh.wikipedia.org/wiki/%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86" target="_blank" rel="external">反向代理</a>。</p><p>反向代理，简而言之，就是一个分发请求的代理。<strong>前向代理</strong> 是直接发给目标服务器，但是它会做一些额外的处理工作。反向代理不一样，它自己相当于是一个服务器，请求到它手里，它根据请求去不同服务器上拉取数据。</p><h3 id="1-安装Nginx"><a href="#1-安装Nginx" class="headerlink" title="1. 安装Nginx"></a>1. 安装Nginx</h3><p>Linux用户可以使用命令行:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">apt-get update</div><div class="line">apt-get install nginx</div></pre></td></tr></table></figure><p>OSX用户可以用Homebrew:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install nginx</div></pre></td></tr></table></figure><p>Windows用户可以<a href="http://nginx.org/en/docs/windows.html" target="_blank" rel="external">下载安装包</a></p><h3 id="2-配置代理"><a href="#2-配置代理" class="headerlink" title="2. 配置代理"></a>2. 配置代理</h3><p>我们希望针对’www.desmond.com/api/something’下的url交由node服务器(2333端口)处理，其他情况下继续发送，可以在<code>nginx.conf</code>里面这么配置（可以在命令行下输入<code>nginx -t</code>找到配置文件位置）：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">server &#123;</div><div class="line">    listen       本机ip:80;</div><div class="line">    server_name  www.desmond.com;</div><div class="line"></div><div class="line">    #charset koi8-r;</div><div class="line"></div><div class="line">    access_log  /Users/desmond/Nginx/api.access.log;</div><div class="line">    error_log  /Users/desmond/Nginx/api.error.log;</div><div class="line"></div><div class="line">    location / &#123; //默认情况原路继续</div><div class="line">        resolver 8.8.8.8;</div><div class="line">        proxy_pass http://$http_host$request_uri;</div><div class="line">        proxy_set_header Host $http_host;</div><div class="line">        proxy_connect_timeout 5;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    location /api &#123;  //检测到api路径下的，转发到端口2333</div><div class="line">        proxy_pass http://localhost:2333;  </div><div class="line">    &#125;</div><div class="line"></div><div class="line">    #error_page  404              /404.html;</div><div class="line"></div><div class="line">    # redirect server error pages to the static page /50x.html</div><div class="line">    #</div><div class="line">    error_page   500 502 503 504  /50x.html;</div><div class="line">    location = /50x.html &#123;</div><div class="line">        root   html;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>这里如果希望原路继续的那些url域名解析配合你的<code>host</code>（此处使用<code>8.8.8.8</code>来做DNS解析），你可以参考<a href="http://stackoverflow.com/questions/8305015/when-using-proxy-pass-can-etc-hosts-be-used-to-resolve-domain-names-instead-of" target="_blank" rel="external">StackOverflow的一个提问</a>。</p><p>这样一来，你所有手机上访问的<code>www.desmond.com/api/something</code>就导到你的nodejs服务器上啦，尽情配置假数据来测试吧~~</p><h3 id="4-配合Charles使用"><a href="#4-配合Charles使用" class="headerlink" title="4. 配合Charles使用"></a>4. 配合Charles使用</h3><p>如果使用Charles的话，手机上一般配的代理是”ip:8888”，那么此时需要做一件事：本地的host设置<code>本机ip www.desmond.com</code>，这样才能保证 <code>www.desmond.com</code>域名下的请求被导流到nginx服务器，从而导流到自己的nodejs服务器上。</p><h2 id="最终搭建"><a href="#最终搭建" class="headerlink" title="最终搭建"></a>最终搭建</h2><p>直接使用node，还是有一些繁琐的。既然我们的目的是“简单”，那么可以考虑一下使用<a href="https://expressjs.com/" target="_blank" rel="external">express</a> 。它封装了很多API，然呢使用起来非常方便。其中一项就是路由(Route)。它意思简单来说就是： <code>www.desmond.com/api/a</code> 由 a 的逻辑处理，<code>www.desmond.com/api/b</code> 由 b 的逻辑处理。</p><p>我相信一个新模块的服务器接口肯定不止一个，假如我们现在接口文档上写着：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">1. 提交个人信息：www.desmond.com/api/personal</div><div class="line">方法：POST</div><div class="line">返回示例：</div><div class="line">&#123;</div><div class="line">  code : 0,</div><div class="line">  time : 1469981217</div><div class="line">&#125;</div><div class="line"></div><div class="line">2. 获取未来n天天气信息：www.desmond.com/api/weather</div><div class="line">方法：GET</div><div class="line">参数：day 未来天数</div><div class="line">返回示例：</div><div class="line">&#123;</div><div class="line">  code : 0,</div><div class="line">  time : 1469981217,</div><div class="line">  data : &#123;</div><div class="line">    items : [</div><div class="line">      date : &apos;2016-08-02&apos;,</div><div class="line">      state : &apos;sunny&apos;</div><div class="line">    ],</div><div class="line">    //...</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>那么你可以使用来做一个简单的ROUTE+请求处理：</p><p><em>server.js</em><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</div><div class="line"><span class="keyword">const</span> url = <span class="built_in">require</span>(<span class="string">'url'</span>);</div><div class="line"><span class="keyword">let</span> app = express();</div><div class="line"></div><div class="line">app.post(<span class="string">'/api/personal'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123; <span class="comment">//针对/api/personal 的 post请求返回</span></div><div class="line">	res.writeHead(<span class="number">200</span>, &#123;<span class="string">'Content-Type'</span>: <span class="string">'text/json;charset=utf-8'</span>&#125;);</div><div class="line">	res.end(<span class="built_in">JSON</span>.stringify(&#123;</div><div class="line">    code : <span class="number">0</span>,</div><div class="line">    time : <span class="number">1469981217</span></div><div class="line">  &#125;));</div><div class="line">&#125;);</div><div class="line"></div><div class="line">app.get(<span class="string">'/api/weather'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123; <span class="comment">//针对/api/weather 的 get请求返回</span></div><div class="line">	res.writeHead(<span class="number">200</span>, &#123;<span class="string">'Content-Type'</span>: <span class="string">'text/json;charset=utf-8'</span>&#125;);</div><div class="line">  <span class="keyword">let</span> count = url.parse(req.url, <span class="literal">true</span>).query.day; <span class="comment">//解析传入的day参数</span></div><div class="line">  <span class="keyword">if</span>(count) &#123; <span class="comment">//若有，根据day参数生成item</span></div><div class="line">    <span class="keyword">let</span> tmpList = [];</div><div class="line">    <span class="keyword">let</span> tmpDate = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; count; i++ ) &#123;</div><div class="line">      tmpDate.setDate(tmpDate.getDate() + <span class="number">1</span>);</div><div class="line">      tmpList.push(&#123;</div><div class="line">        date : <span class="string">`<span class="subst">$&#123;tmpDate.getFullYear()&#125;</span>-<span class="subst">$&#123;tmpDate.getMonth() + <span class="number">1</span>&#125;</span>-<span class="subst">$&#123;tmpDate.getDate()&#125;</span>`</span>,</div><div class="line">        state : <span class="string">`sunny - <span class="subst">$&#123;i&#125;</span>`</span></div><div class="line">      &#125;);</div><div class="line">    &#125;</div><div class="line">    res.end(<span class="built_in">JSON</span>.stringify(&#123;</div><div class="line">      code : <span class="number">0</span>,</div><div class="line">      time : <span class="number">1469981217</span>,</div><div class="line">      items : tmpList</div><div class="line">    &#125;));</div><div class="line">  &#125; <span class="keyword">else</span> &#123; <span class="comment">//若无，则返回错误信息</span></div><div class="line">    res.end(<span class="built_in">JSON</span>.stringify(&#123;</div><div class="line">      code : <span class="number">-1</span>,</div><div class="line">      msg: <span class="string">'you must send param \"day\"'</span>,</div><div class="line">      time : <span class="number">1469981217</span></div><div class="line">    &#125;));</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line">app.listen(<span class="number">2333</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</div><div class="line">	<span class="built_in">console</span>.log(<span class="string">`You have run node host.`</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure><p></p><p>注意：不要忘记安装express，（npm install express –save)即可。</p><p>编辑结束后运行一下<code>node server.js</code>，你可以看到输出：</p><blockquote><p><code>You have run node host.</code></p></blockquote><p>这时我们可以尝试请求一下 <code>localhost:2333</code>，可以看到返回：</p><p><img src="/image/fake-server.png" alt="image"></p><p>大功告成~~</p><p>如果希望node server一直在后台跑（使用<code>node server.js</code>时shell会卡在当前运行中），可以使用<a href="https://github.com/foreverjs/forever" target="_blank" rel="external">ForeverJS</a>。</p><h2 id="更简单的办法"><a href="#更简单的办法" class="headerlink" title="更简单的办法"></a>更简单的办法</h2><p>如果不想折腾太多，可以直接写一个json静态文件去返回：</p><p><em>data.json</em><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="string">"code"</span> : <span class="number">0</span>,</div><div class="line">  <span class="string">"time"</span> : <span class="number">1469981217</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p></p><p>*注意：手写json的话，里面的 key 必须以字符串形式（双冒号包围）存在。</p><p><em>server.js</em><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</div><div class="line"><span class="keyword">let</span> app = express();</div><div class="line"></div><div class="line">app.get(<span class="string">'/api/weather'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123; <span class="comment">//针对/api/weather 的 get请求返回</span></div><div class="line">  res.writeHead(<span class="number">200</span>, &#123;<span class="string">'Content-Type'</span>: <span class="string">'text/json;charset=utf-8'</span>&#125;);</div><div class="line">  fs.readFile(<span class="string">'data.json'</span>, <span class="string">'utf8'</span>, (err, data) =&gt; &#123; <span class="comment">//读取data.json</span></div><div class="line">    <span class="keyword">if</span>(err) &#123; <span class="comment">//错误时返回异常</span></div><div class="line">      res.end(<span class="built_in">JSON</span>.stringify(&#123;</div><div class="line">        code : <span class="number">-1</span>,</div><div class="line">        msg : <span class="string">'Read File error!'</span></div><div class="line">      &#125;));</div><div class="line">      <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    res.end(data);</div><div class="line">  &#125;);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"></div><div class="line">app.listen(<span class="number">2333</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">`You have run node host.`</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure><p></p><p>这样就非常简单，不过缺点就是无法动态地处理。</p></div><footer class="post-footer"><div class="post-tags"><a href="/tags/Android/" rel="tag"># Android</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/mockito-roboletric-test/" rel="next" title="使用Mockito和Roboletric进行Android单元测试"><i class="fa fa-chevron-left"></i> 使用Mockito和Roboletric进行Android单元测试</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/android-test/" rel="prev" title="Android测试驱动开发(TDD)">Android测试驱动开发(TDD) <i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"></div></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap">站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><p class="site-author-name" itemprop="name">Desmond Yao</p><p class="site-description motion-element" itemprop="description">Android developer.</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">21</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/index.html"><span class="site-state-item-count">17</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="links-of-author motion-element"></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#使用node搭建起简单的服务器脚本"><span class="nav-number">1.</span> <span class="nav-text">使用node搭建起简单的服务器脚本</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-安装"><span class="nav-number">1.1.</span> <span class="nav-text">1. 安装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-简单服务器"><span class="nav-number">1.2.</span> <span class="nav-text">2. 简单服务器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-IDE配置"><span class="nav-number">1.3.</span> <span class="nav-text">3. IDE配置</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Nginx反向代理"><span class="nav-number">2.</span> <span class="nav-text">Nginx反向代理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-安装Nginx"><span class="nav-number">2.1.</span> <span class="nav-text">1. 安装Nginx</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-配置代理"><span class="nav-number">2.2.</span> <span class="nav-text">2. 配置代理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-配合Charles使用"><span class="nav-number">2.3.</span> <span class="nav-text">4. 配合Charles使用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#最终搭建"><span class="nav-number">3.</span> <span class="nav-text">最终搭建</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#更简单的办法"><span class="nav-number">4.</span> <span class="nav-text">更简单的办法</span></a></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2017</span> <span class="with-love"><i class="fa fa-user"></i> </span><span class="author" itemprop="copyrightHolder">Desmond Yao</span></div><div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div><span class="post-meta-divider">|</span><div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.3</div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script></body></html>